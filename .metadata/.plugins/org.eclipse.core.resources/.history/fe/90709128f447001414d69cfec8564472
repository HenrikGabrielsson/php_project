<?php

namespace model\repository;

require_once("./model/repo/Repository.php");
require_once("./model/User.php");

class UserRepo extends \model\repository\Repository
{
	//fältnamn i databasen
	private $id = "userID";            
    private $userName = "userName";     
    private $email = "email";         
    private $password = "pasword";      
    private $salt = "salt";          
    private $dateAdded = "dateAdded";     
    private $admin = "status";

	//hämta en användare
	public function getUserById($id)
	{		
		
		//skapar en sql sats och parametrar som ska skickas med.
		$sql = 'SELECT * FROM user WHERE userID = ? ';
		$params = array($id);
		
		$this->connect();
		
		//förbered frågan och kör den sedan (med params)
		$query = $this->dbConnection->prepare($sql);
		$query->execute($params);
		
		
		//hämtar användaren (kommer som en array om den hittades, annars FALSE)
		$result = $query->fetch();
		
		//lägger in datan i ett User-objekt och returnerar
		$user;
		if($result)
		{
			$user = new \model\User
			(
				$result[$this->id],
				$result[$this->userName],
				$result[$this->email],
				$result[$this->password],
				$result[$this->salt],
				$result[$this->dateAdded],
				$result[$this->admin]		
			);
		}
		
		return $user;
		
	}
	
	public function add(\model\User $user)
	{
		echo "test";
		$sql = "INSERT INTO user(".$this->userName.", ".$this->email.",".$this->password.",".$this->salt.",".$this->dateAdded.",".$this->admin.")VALUES(?,?,?,?,?,?)";
		$params = array($user->getUserName(), $user->getEmail(), $user->getPassword(), $user->getSalt(),$user->getDateAdded(), 0);
		
		$this->connect();
		
		$query = $this->dbConnection->prepare($sql);
		$query->execute($params);
		
		$query->fetch();
	}
	
}



